#!/bin/sh

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    source ../set_env.sh
else
    source ./set_env.sh
fi

echo "ðŸ–¥  Setting up other utils..."

echo "ðŸš› Moving SSH configuration files"

# Removes ~/.ssh/config if it exists and symlinks the .ssh/config file from the .dotfiles
mkdir -p "$HOME/.ssh"
rm -f "$HOME/.ssh/config"
rm -f "$HOME/.ssh/config.d"

ln -s "$DOTFILES/ssh/config" "$HOME/.ssh/config"
ln -s "$DOTFILES/ssh/config.d" "$HOME/.ssh/config.d"

cd "$DOTFILES/private/keys/"
for dir in */ ; do
    dir=${dir%?}
    rm -f "$HOME/.ssh/$dir"
    ln -s "$DOTFILES/private/keys/$dir" "$HOME/.ssh/$dir"
done

echo "ðŸš› Creating Randomize Screensaver Agent"

rm -f ~/Library/LaunchAgents/io.alejakun.screensavers.plist
sudo rm -f /usr/local/bin/randomize_screensaver.sh
ln -s ~/.dotfiles/macos/launchctl/agents/io.alejakun.screensavers.plist  ~/Library/LaunchAgents/io.alejakun.screensavers.plist
sudo ln -s ~/.dotfiles/macos/launchctl/scripts/randomize_screensaver.sh /usr/local/bin/randomize_screensaver.sh
sudo launchctl bootstrap gui/`id -u` ~/Library/LaunchAgents/io.alejakun.screensavers.plist
# macos/launchctl bootout gui/`id -u` ~/Library/LaunchAgents/io.alejakun.screensavers.plist

# echo "ðŸš› Moving etc/hosts file"

# rm -f "/etc/hosts"
# ln -s "$DOTFILES/etc/hosts" "/etc/hosts"

# echo "ðŸš› Moving karabiner configuration file"

# rm -f "~/.config/karabiner/karabiner.json"
# cp "$DOTFILES/macos/karabiner/karabiner.json" "$HOME/.config/karabiner/karabiner.json"
